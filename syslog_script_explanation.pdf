%PDF-1.4
%‚„œ”
1 0 obj
<< /Type /Catalog /Pages 2 0 R >>
endobj
2 0 obj
<< /Type /Pages /Kids [3 0 R 4 0 R 5 0 R 6 0 R] /Count 4 >>
endobj
3 0 obj
<< /Type /Page /Parent 2 0 R /MediaBox [0 0 612 792] /Contents 7 0 R /Resources << /Font << /F1 11 0 R >> >> >>
endobj
4 0 obj
<< /Type /Page /Parent 2 0 R /MediaBox [0 0 612 792] /Contents 8 0 R /Resources << /Font << /F1 11 0 R >> >> >>
endobj
5 0 obj
<< /Type /Page /Parent 2 0 R /MediaBox [0 0 612 792] /Contents 9 0 R /Resources << /Font << /F1 11 0 R >> >> >>
endobj
6 0 obj
<< /Type /Page /Parent 2 0 R /MediaBox [0 0 612 792] /Contents 10 0 R /Resources << /Font << /F1 11 0 R >> >> >>
endobj
7 0 obj
<< /Length 2830 >>
stream
BT
/F1 10 Tf
1 0 0 1 40 780 Tm (#!/usr/bin/env bash) Tj
1 0 0 1 40 768 Tm (    Shebang: tells the OS to run this script using the bash interpreter found via env.) Tj
1 0 0 1 40 756 Tm () Tj
1 0 0 1 40 744 Tm (set -euo pipefail) Tj
1 0 0 1 40 732 Tm (    Enables strict error handling: -e exit on error, -u error on undefined vars, pipefail catches pipeline failures.) Tj
1 0 0 1 40 720 Tm () Tj
1 0 0 1 40 708 Tm (if [[ $# -lt 1 ]]; then) Tj
1 0 0 1 40 696 Tm (    Checks if fewer than one argument was supplied.) Tj
1 0 0 1 40 684 Tm () Tj
1 0 0 1 40 672 Tm (  echo "Usage: $0 <syslog_file>") Tj
1 0 0 1 40 660 Tm (    Prints usage instructions.) Tj
1 0 0 1 40 648 Tm () Tj
1 0 0 1 40 636 Tm (  exit 1) Tj
1 0 0 1 40 624 Tm (    Exits the script because a required argument is missing.) Tj
1 0 0 1 40 612 Tm () Tj
1 0 0 1 40 600 Tm (fi) Tj
1 0 0 1 40 588 Tm (    Ends the if-statement for argument checking.) Tj
1 0 0 1 40 576 Tm () Tj
1 0 0 1 40 564 Tm (LOG_FILE="$1") Tj
1 0 0 1 40 552 Tm (    Stores the first argument as the log file path.) Tj
1 0 0 1 40 540 Tm () Tj
1 0 0 1 40 528 Tm (if [[ ! -r "$LOG_FILE" ]]; then) Tj
1 0 0 1 40 516 Tm (    Checks whether the target log file is readable.) Tj
1 0 0 1 40 504 Tm () Tj
1 0 0 1 40 492 Tm (  echo "File '$LOG_FILE' is not readable") Tj
1 0 0 1 40 480 Tm (    Prints an error if the file cannot be read.) Tj
1 0 0 1 40 468 Tm () Tj
1 0 0 1 40 456 Tm (  exit 1) Tj
1 0 0 1 40 444 Tm (    Exits because the file cannot be used.) Tj
1 0 0 1 40 432 Tm () Tj
1 0 0 1 40 420 Tm (fi) Tj
1 0 0 1 40 408 Tm (    Ends the readability check.) Tj
1 0 0 1 40 396 Tm () Tj
1 0 0 1 40 384 Tm (KEYWORDS=\("ERROR" "WARNING" "FATAL" "CRITICAL"\)) Tj
1 0 0 1 40 372 Tm (    Defines an array of keywords the script will search for.) Tj
1 0 0 1 40 360 Tm () Tj
1 0 0 1 40 348 Tm (declare -A IP_COUNTS) Tj
1 0 0 1 40 336 Tm (    Creates an associative array that maps IP ‚Üí count.) Tj
1 0 0 1 40 324 Tm () Tj
1 0 0 1 40 312 Tm (declare -A IP_KEYWORDS) Tj
1 0 0 1 40 300 Tm (    Creates an associative array that maps IP ‚Üí keywords found.) Tj
1 0 0 1 40 288 Tm () Tj
1 0 0 1 40 276 Tm (find_ip_in_line\(\) {) Tj
1 0 0 1 40 264 Tm (    Starts a function that extracts an IP address from a log line.) Tj
1 0 0 1 40 252 Tm () Tj
1 0 0 1 40 240 Tm (  local line="$1") Tj
1 0 0 1 40 228 Tm (    Stores the function's input line in a local variable.) Tj
1 0 0 1 40 216 Tm () Tj
1 0 0 1 40 204 Tm (  local ip) Tj
1 0 0 1 40 192 Tm (    Declares a local variable to hold the extracted IP.) Tj
1 0 0 1 40 180 Tm () Tj
1 0 0 1 40 168 Tm (  ip=$\(grep -Eo '\([0-9]{1,3}\\.\){3}[0-9]{1,3}' <<< "$line" | head -n 1 || true\)) Tj
1 0 0 1 40 156 Tm (    Uses grep with a regex to extract the first IPv4 address found in the line.) Tj
1 0 0 1 40 144 Tm () Tj
1 0 0 1 40 132 Tm (  if [[ -n "$ip" ]]; then) Tj
ET
endstream
endobj
8 0 obj
<< /Length 2504 >>
stream
BT
/F1 10 Tf
1 0 0 1 40 780 Tm (    Checks whether an IP was successfully found.) Tj
1 0 0 1 40 768 Tm () Tj
1 0 0 1 40 756 Tm (    echo "$ip") Tj
1 0 0 1 40 744 Tm (    Outputs the extracted IP to the caller.) Tj
1 0 0 1 40 732 Tm () Tj
1 0 0 1 40 720 Tm (  fi) Tj
1 0 0 1 40 708 Tm (    Ends the if-block for IP presence.) Tj
1 0 0 1 40 696 Tm () Tj
1 0 0 1 40 684 Tm (}) Tj
1 0 0 1 40 672 Tm (    Ends the IP extraction function.) Tj
1 0 0 1 40 660 Tm () Tj
1 0 0 1 40 648 Tm (find_keywords_in_line\(\) {) Tj
1 0 0 1 40 636 Tm (    Starts a function that extracts matching keywords from a line.) Tj
1 0 0 1 40 624 Tm () Tj
1 0 0 1 40 612 Tm (  local line="$1") Tj
1 0 0 1 40 600 Tm (    Input line is stored locally.) Tj
1 0 0 1 40 588 Tm () Tj
1 0 0 1 40 576 Tm (  local found=\(\)) Tj
1 0 0 1 40 564 Tm (    Local array to store any matching keywords.) Tj
1 0 0 1 40 552 Tm () Tj
1 0 0 1 40 540 Tm (  for kw in "${KEYWORDS[@]}"; do) Tj
1 0 0 1 40 528 Tm (    Iterates over each defined keyword.) Tj
1 0 0 1 40 516 Tm () Tj
1 0 0 1 40 504 Tm (    if [[ "${line^^}" == *"${kw^^}"* ]]; then) Tj
1 0 0 1 40 492 Tm (    Performs case-insensitive keyword search.) Tj
1 0 0 1 40 480 Tm () Tj
1 0 0 1 40 468 Tm (      found+=\("$kw"\)) Tj
1 0 0 1 40 456 Tm (    Adds matched keyword to the found list.) Tj
1 0 0 1 40 444 Tm () Tj
1 0 0 1 40 432 Tm (    fi) Tj
1 0 0 1 40 420 Tm (    Ends the if-statement checking keyword presence.) Tj
1 0 0 1 40 408 Tm () Tj
1 0 0 1 40 396 Tm (  done) Tj
1 0 0 1 40 384 Tm (    Ends the keyword loop.) Tj
1 0 0 1 40 372 Tm () Tj
1 0 0 1 40 360 Tm (  if [[ ${#found[@]} -gt 0 ]]; then) Tj
1 0 0 1 40 348 Tm (    If one or more keywords were found...) Tj
1 0 0 1 40 336 Tm () Tj
1 0 0 1 40 324 Tm (    echo "${found[@]}") Tj
1 0 0 1 40 312 Tm (    Output space-separated list of matched keywords.) Tj
1 0 0 1 40 300 Tm () Tj
1 0 0 1 40 288 Tm (  fi) Tj
1 0 0 1 40 276 Tm (    Ends the if-block.) Tj
1 0 0 1 40 264 Tm () Tj
1 0 0 1 40 252 Tm (}) Tj
1 0 0 1 40 240 Tm (    Ends the keyword extraction function.) Tj
1 0 0 1 40 228 Tm () Tj
1 0 0 1 40 216 Tm (while IFS= read -r line; do) Tj
1 0 0 1 40 204 Tm (    Reads the log file line-by-line without trimming whitespace.) Tj
1 0 0 1 40 192 Tm () Tj
1 0 0 1 40 180 Tm (  ip=$\(find_ip_in_line "$line" || true\)) Tj
1 0 0 1 40 168 Tm (    Extracts an IP from the current line.) Tj
1 0 0 1 40 156 Tm () Tj
1 0 0 1 40 144 Tm (  [[ -z "$ip" ]] && continue) Tj
1 0 0 1 40 132 Tm (    Skips the line if no IP was detected.) Tj
ET
endstream
endobj
9 0 obj
<< /Length 2740 >>
stream
BT
/F1 10 Tf
1 0 0 1 40 780 Tm () Tj
1 0 0 1 40 768 Tm (  kws=$\(find_keywords_in_line "$line" || true\)) Tj
1 0 0 1 40 756 Tm (    Extracts keywords from the line.) Tj
1 0 0 1 40 744 Tm () Tj
1 0 0 1 40 732 Tm (  [[ -z "$kws" ]] && continue) Tj
1 0 0 1 40 720 Tm (    Skips the line if no relevant keywords were found.) Tj
1 0 0 1 40 708 Tm () Tj
1 0 0 1 40 696 Tm (  current_count=${IP_COUNTS["$ip"]:-0}) Tj
1 0 0 1 40 684 Tm (    Gets the current count for this IP \(defaulting to 0\).) Tj
1 0 0 1 40 672 Tm () Tj
1 0 0 1 40 660 Tm (  IP_COUNTS["$ip"]=$\(\( current_count + 1 \)\)) Tj
1 0 0 1 40 648 Tm (    Increments the count for this IP.) Tj
1 0 0 1 40 636 Tm () Tj
1 0 0 1 40 624 Tm (  for kw in $kws; do) Tj
1 0 0 1 40 612 Tm (    Loops through all keywords found in this line.) Tj
1 0 0 1 40 600 Tm () Tj
1 0 0 1 40 588 Tm (    existing="${IP_KEYWORDS[$ip]:-}") Tj
1 0 0 1 40 576 Tm (    Gets the existing keyword list for this IP.) Tj
1 0 0 1 40 564 Tm () Tj
1 0 0 1 40 552 Tm (    if [[ " $existing " != *" $kw "* ]]; then) Tj
1 0 0 1 40 540 Tm (    Checks if this keyword is not already stored.) Tj
1 0 0 1 40 528 Tm () Tj
1 0 0 1 40 516 Tm (      IP_KEYWORDS["$ip"]="$existing $kw") Tj
1 0 0 1 40 504 Tm (    Appends the keyword to the list for this IP.) Tj
1 0 0 1 40 492 Tm () Tj
1 0 0 1 40 480 Tm (    fi) Tj
1 0 0 1 40 468 Tm (    Ends keyword duplication check.) Tj
1 0 0 1 40 456 Tm () Tj
1 0 0 1 40 444 Tm (  done) Tj
1 0 0 1 40 432 Tm (    Ends keyword loop.) Tj
1 0 0 1 40 420 Tm () Tj
1 0 0 1 40 408 Tm (done < "$LOG_FILE") Tj
1 0 0 1 40 396 Tm (    Finishes reading all lines from the file.) Tj
1 0 0 1 40 384 Tm () Tj
1 0 0 1 40 372 Tm (DATE_PART=$\(date '+%d-%b-%Y_%H-%M' | tr 'A-Z' 'a-z'\)) Tj
1 0 0 1 40 360 Tm (    Generates a lowercase timestamp containing date and time.) Tj
1 0 0 1 40 348 Tm () Tj
1 0 0 1 40 336 Tm (REPORT_FILE="report-${DATE_PART}.rep") Tj
1 0 0 1 40 324 Tm (    Names the output report file.) Tj
1 0 0 1 40 312 Tm () Tj
1 0 0 1 40 300 Tm ({) Tj
1 0 0 1 40 288 Tm (    Begins a group of commands whose output goes to the report file.) Tj
1 0 0 1 40 276 Tm () Tj
1 0 0 1 40 264 Tm (  echo "*******************************************************************************") Tj
1 0 0 1 40 252 Tm (    Writes a decorative header line.) Tj
1 0 0 1 40 240 Tm () Tj
1 0 0 1 40 228 Tm (  echo "Report created at $\(date +%H:%M\)") Tj
1 0 0 1 40 216 Tm (    Writes the time the report was generated.) Tj
1 0 0 1 40 204 Tm () Tj
1 0 0 1 40 192 Tm (  echo) Tj
1 0 0 1 40 180 Tm (    Outputs a blank line for spacing.) Tj
1 0 0 1 40 168 Tm () Tj
1 0 0 1 40 156 Tm (  for ip in "${!IP_COUNTS[@]}"; do) Tj
1 0 0 1 40 144 Tm (    Iterates through each IP address recorded.) Tj
1 0 0 1 40 132 Tm () Tj
ET
endstream
endobj
10 0 obj
<< /Length 1634 >>
stream
BT
/F1 10 Tf
1 0 0 1 40 780 Tm (    count=${IP_COUNTS[$ip]}) Tj
1 0 0 1 40 768 Tm (    Fetches how many lines were associated with this IP.) Tj
1 0 0 1 40 756 Tm () Tj
1 0 0 1 40 744 Tm (    kws=${IP_KEYWORDS[$ip]}) Tj
1 0 0 1 40 732 Tm (    Fetches the keywords associated with this IP.) Tj
1 0 0 1 40 720 Tm () Tj
1 0 0 1 40 708 Tm (    kws=$\(echo "$kws" | xargs\)) Tj
1 0 0 1 40 696 Tm (    Trims extra whitespace from keywords.) Tj
1 0 0 1 40 684 Tm () Tj
1 0 0 1 40 672 Tm (    echo "${ip} address appeared in ${count} lines.") Tj
1 0 0 1 40 660 Tm (    Prints how often the IP appeared.) Tj
1 0 0 1 40 648 Tm () Tj
1 0 0 1 40 636 Tm (    echo "keywords appeared: ${kws}") Tj
1 0 0 1 40 624 Tm (    Prints the keywords for that IP.) Tj
1 0 0 1 40 612 Tm () Tj
1 0 0 1 40 600 Tm (    echo) Tj
1 0 0 1 40 588 Tm (    Prints a blank line for readability.) Tj
1 0 0 1 40 576 Tm () Tj
1 0 0 1 40 564 Tm (  done) Tj
1 0 0 1 40 552 Tm (    Ends the per-IP loop.) Tj
1 0 0 1 40 540 Tm () Tj
1 0 0 1 40 528 Tm (  echo "*******************************************************************************") Tj
1 0 0 1 40 516 Tm (    Writes the closing decorative line.) Tj
1 0 0 1 40 504 Tm () Tj
1 0 0 1 40 492 Tm (} > "$REPORT_FILE") Tj
1 0 0 1 40 480 Tm (    Redirects the entire report block into the report file.) Tj
1 0 0 1 40 468 Tm () Tj
1 0 0 1 40 456 Tm (echo "file name: $REPORT_FILE") Tj
1 0 0 1 40 444 Tm (    Prints the generated report file name for the user.) Tj
1 0 0 1 40 432 Tm () Tj
1 0 0 1 40 420 Tm (cat "$REPORT_FILE") Tj
1 0 0 1 40 408 Tm (    Displays the entire report to the terminal.) Tj
1 0 0 1 40 396 Tm () Tj
ET
endstream
endobj
11 0 obj
<< /Type /Font /Subtype /Type1 /BaseFont /Helvetica >>
endobj
xref
0 12
0000000000 65535 f 
0000000015 00000 n 
0000000064 00000 n 
0000000139 00000 n 
0000000266 00000 n 
0000000393 00000 n 
0000000520 00000 n 
0000000648 00000 n 
0000003529 00000 n 
0000006084 00000 n 
0000008875 00000 n 
0000010561 00000 n 
trailer
<< /Size 12 /Root 1 0 R >>
startxref
10632
%%EOF